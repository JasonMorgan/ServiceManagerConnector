<ManagementPack ContentReadable="true" SchemaVersion="2.0" OriginalSchemaVersion="1.1" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <Manifest>
    <Identity>
      <ID>vz_custom_workflows</ID>
      <Version>1.0.0.0</Version>
    </Identity>
    <Name>vz_custom_workflows</Name>
    <References>
      <Reference Alias="System">
        <ID>System.Library</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Console">
        <ID>Microsoft.EnterpriseManagement.ServiceManager.UI.Console</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="EnterpriseManagement">
        <ID>Microsoft.EnterpriseManagement.ServiceManager.UI.Administration</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="SystemCenter">
        <ID>Microsoft.SystemCenter.Library</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="SystemCenter1">
        <ID>Microsoft.SystemCenter.Subscriptions</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Core">
        <ID>ServiceManager.Core.Library</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Windows">
        <ID>Microsoft.Windows.Library</ID>
        <Version>7.0.0.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
    </References>
  </Manifest>
  <TypeDefinitions>
    <ModuleTypes>
      <WriteActionModuleType ID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee.MT" Accessibility="Public" RunAs="Core!Microsoft.SystemCenter.ServiceManager.WorkflowAccount" Batching="false">
        <Configuration>
          <IncludeSchemaTypes>
            <SchemaType>System!System.CommandExecuterSchema</SchemaType>
          </IncludeSchemaTypes>
        </Configuration>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <WriteAction ID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee.CmdWA" TypeID="System!System.CommandExecuter">
                <ApplicationName>%windir%\system32\cmd.exe</ApplicationName>
                <WorkingDirectory />
                <CommandLine>/c DoWork.cmd </CommandLine>
                <TimeoutSeconds>300</TimeoutSeconds>
                <RequireOutput>true</RequireOutput>
                <Files>
                  <File>
                    <Name>DoWork.cmd</Name>
                    <Contents>Powershell.exe -command "c:\isdps\Scripts\SevOne\SevOneAlertsConnector.ps1 -SevOneCred (New-Object pscredential -ArgumentList 'admin',(ConvertTo-SecureString -AsPlainText -Force SevOne))"</Contents>
                    <Unicode>false</Unicode>
                  </File>
                </Files>
              </WriteAction>
            </MemberModules>
            <Composition>
              <Node ID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee.CmdWA" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <InputType>System!System.BaseData</InputType>
      </WriteActionModuleType>
    </ModuleTypes>
  </TypeDefinitions>
  <Categories>
    <Category ID="vz_custom_workflows.Category" Value="Console!Microsoft.EnterpriseManagement.ServiceManager.ManagementPack">
      <ManagementPackName>vz_custom_workflows</ManagementPackName>
      <ManagementPackVersion>1.0.0.0</ManagementPackVersion>
    </Category>
    <Category ID="SevOneAlertsConnectorCategory" Target="SevOneAlertsConnector" Value="EnterpriseManagement!Microsoft.EnterpriseManagement.ServiceManager.Rules.WorkflowSubscriptions" />
  </Categories>
  <Monitoring>
    <Rules>
      <Rule ID="SevOneAlertsConnector" Enabled="true" Target="SystemCenter!Microsoft.SystemCenter.SubscriptionWorkflowTarget" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>Notification</Category>
        <DataSources>
          <DataSource ID="SchedulerDS" RunAs="SystemCenter!Microsoft.SystemCenter.DatabaseWriteActionAccount" TypeID="System!System.Scheduler">
            <Scheduler>
              <SimpleReccuringSchedule>
                <Interval Unit="Seconds">30</Interval>
              </SimpleReccuringSchedule>
              <ExcludeDates />
            </Scheduler>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="WA" TypeID="SystemCenter1!Microsoft.EnterpriseManagement.SystemCenter.Subscription.WindowsWorkflowTaskWriteAction">
            <Subscription>
              <WindowsWorkflowConfiguration>
                <AssemblyName>SevOneAlertsConnector</AssemblyName>
                <WorkflowTypeName>WorkflowAuthoring.SevOneAlertsConnector</WorkflowTypeName>
                <WorkflowParameters></WorkflowParameters>
                <RetryExceptions></RetryExceptions>
                <RetryDelaySeconds>60</RetryDelaySeconds>
                <MaximumRunningTimeSeconds>300</MaximumRunningTimeSeconds>
              </WindowsWorkflowConfiguration>
            </Subscription>
          </WriteAction>
        </WriteActions>
      </Rule>
    </Rules>
    <Tasks>
      <Task ID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee" Accessibility="Public" Enabled="true" Target="Windows!Microsoft.Windows.Computer" Timeout="300" Remotable="true">
        <Category>Notification</Category>
        <WriteAction ID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee.WA" TypeID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee.MT" />
      </Task>
    </Tasks>
  </Monitoring>
  <LanguagePacks>
    <LanguagePack ID="ENU" IsDefault="true">
      <DisplayStrings>
        <DisplayString ElementID="vz_custom_workflows">
          <Name>vz_custom_workflows</Name>
        </DisplayString>
        <DisplayString ElementID="SevOneAlertsConnector">
          <Name>SevOneAlertsConnector</Name>
          <Description>Used to connect to a SevOne Instance</Description>
        </DisplayString>
        <DisplayString ElementID="SevOneAlertsConnector" SubElementID="WA">
          <Name>Used to connect to a SevOne Instance</Name>
          <Description>Used to connect to a SevOne Instance</Description>
        </DisplayString>
        <DisplayString ElementID="SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee">
          <Name>SevOneAlertsConnector.CommandScript.e28d1063_547d_4902_b96b_ddac9eedb1ee</Name>
        </DisplayString>
      </DisplayStrings>
    </LanguagePack>
  </LanguagePacks>
</ManagementPack>
